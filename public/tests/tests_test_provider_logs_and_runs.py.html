<!doctype html><html><head><meta charset="utf-8"><title>Tests: tests\test_provider_logs_and_runs.py</title><link rel="stylesheet" href="tests.css"></head><body><div class="wrap"><h1>Tests: tests\test_provider_logs_and_runs.py</h1><p><a href="index.html">Back to tests index</a></p><div class="items"><h2>Test functions</h2><ul><li>test_provider_health_logs_endpoint_empty_or_present</li><li>test_test_runs_endpoint_requires_run_and_returns</li></ul><h3>Markers / Types</h3><ul><li>type: smoke</li></ul></div><h2>Source</h2><pre class="source">import os, sys
ROOT = os.path.abspath(os.path.join(os.path.dirname(__file__), &#x27;..&#x27;))
sys.path.insert(0, os.path.join(ROOT, &#x27;python-tools&#x27;))
from fastapi.testclient import TestClient
import api_server_v9 as server

client = TestClient(server.app)


def test_provider_health_logs_endpoint_empty_or_present():
    # Ensure endpoint returns structure
    resp = client.get(&#x27;/tools/provider-health-logs&#x27;)
    assert resp.status_code == 200
    data = resp.json()
    assert &#x27;lines&#x27; in data


def test_test_runs_endpoint_requires_run_and_returns():
    # Ensure running internal tests writes to test_runs.log
    server.Config.DEBUG = True
    r = client.post(&#x27;/tools/run-internal-tests&#x27;, json={&#x27;suite&#x27;: &#x27;smoke&#x27;})
    assert r.status_code == 200
    # Now fetch test runs
    rr = client.get(&#x27;/tools/test-runs&#x27;)
    assert rr.status_code == 200
    d = rr.json()
    assert &#x27;runs&#x27; in d
    # runs may be empty if runner timed out; ensure structure
    assert isinstance(d[&#x27;runs&#x27;], list)
</pre></div></body></html>